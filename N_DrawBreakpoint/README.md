# DrawBreakpoint

*Draw breakpoints with coordinates given by posA, posB.  Add additional layers for 
additional datasets as required.*

This stage has expanded discussion of modifying of workflow, which is applicable for other drawing stages.  See
[Development Notes](../Development.md) for additional details.

The Breakpoint Panel (the upper right panel in BPS Structure plot), illustrates
positions of breakpoints on an X,Y plane.  For the TCGA_Virus workflow, the steps are,

1. **Draw Pindel predictions**.  Create GGP file with regions (rectangles) corresponding to 
   Pindel RP predictions
2. **Draw Discordant predictions**.  Draw a point corresponding to location of discordant read.
3. **Draw Contig predictions** Draw a + symbol corresponding to Contig prediction.

Steps 2 and 3 read in GGP file generated by the previous step, add a layer visualizing the data
being plotted and save the new GGP file.  Additional tools can be added here in an analogous
way.  

```
plot.ggp = ggplot() + geom_rect( pindel.data )
saveRDS()
```
followed by 
```
plot.ggp = readRDS() + geom_point ( discordant.data )
saveRDS()
```

We create `dat/GGP` as a soft link (`ln -s`) to the output directory of the most recent GGP step
as a convenience for downstream stages.

By definition, here chrom A and B correspond to X and Y axes, resp.  Also by
definition of [BPC/BPR](../Development.md) data, `chrom a < chrom b`.  By default, chrom a = chrom A
and chrom b = chrom B, but this can be changed with `FLIP_AB` parameter defined
in `../bps.config`.  This allows control chrom/virus axes.

